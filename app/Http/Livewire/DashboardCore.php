<?php

namespace App\Http\Livewire;

use Livewire\Component;

class DashboardCore extends Component
{
    public $activeTab = 'general-information';
    public $selectedCompany = 'ASII';
    public $incomeStatementData = [];

    public $companies = [
        'ASII' => [
            'name' => 'Astra International Indonesia Tbk',
            'address' => 'Menara Astra, 59th Floor, Jl. Jend. Sudirman Kav. 5-6 Central Jakarta, DKI Jakarta',
            'marketCap' => '173,67 T IDR',
            'price' => '90.8B',
            'growth' => '82.08%',
            'revenueData' => [
                'revenue' => [
                    'Q1' => ['2024' => '35.990 B', '2023' => '35.990 B', '2022' => '35.990 B'],
                    'Q2' => ['2024' => '24.990 B', '2023' => '24.990 B', '2022' => '24.990 B'],
                    'Q3' => ['2024' => '35.990 B', '2023' => '35.990 B', '2022' => '35.990 B'],
                    'Q4' => ['2024' => '65.990 B', '2023' => '24.990 B', '2022' => '24.990 B'],
                ],
                'grossProfit' => [
                    'Q1' => ['2024' => '35.990 B', '2023' => '35.990 B', '2022' => '35.990 B'],
                    'Q2' => ['2024' => '24.990 B', '2023' => '24.990 B', '2022' => '24.990 B'],
                    'Q3' => ['2024' => '35.990 B', '2023' => '35.990 B', '2022' => '35.990 B'],
                    'Q4' => ['2024' => '85.990 B', '2023' => '24.990 B', '2022' => '24.990 B'],
                ],
                'netProfit' => [
                    'Q1' => ['2024' => '35.990 B', '2023' => '35.990 B', '2022' => '35.990 B'],
                    'Q2' => ['2024' => '24.990 B', '2023' => '24.990 B', '2022' => '24.990 B'],
                    'Q3' => ['2024' => '35.990 B', '2023' => '35.990 B', '2022' => '35.990 B'],
                    'Q4' => ['2024' => '55.990 B', '2023' => '24.990 B', '2022' => '24.990 B'],
                ],
            ],
            'financialPositionData' => [
                'asset' => [
                    'Q1' => ['2024' => '500.000 B', '2023' => '450.000 B', '2022' => '400.000 B'],
                    'Q2' => ['2024' => '450.000 B', '2023' => '400.000 B', '2022' => '350.000 B'],
                    'Q3' => ['2024' => '400.000 B', '2023' => '350.000 B', '2022' => '300.000 B'],
                    'Q4' => ['2024' => '350.000 B', '2023' => '300.000 B', '2022' => '250.000 B'],
                ],
                'liability' => [
                    'Q1' => ['2024' => '300.000 B', '2023' => '250.000 B', '2022' => '200.000 B'],
                    'Q2' => ['2024' => '250.000 B', '2023' => '200.000 B', '2022' => '150.000 B'],
                    'Q3' => ['2024' => '200.000 B', '2023' => '150.000 B', '2022' => '100.000 B'],
                    'Q4' => ['2024' => '150.000 B', '2023' => '100.000 B', '2022' => '50.000 B'],
                ],
                'equity' => [
                    'Q1' => ['2024' => '200.000 B', '2023' => '200.000 B', '2022' => '200.000 B'],
                    'Q2' => ['2024' => '200.000 B', '2023' => '200.000 B', '2022' => '200.000 B'],
                    'Q3' => ['2024' => '200.000 B', '2023' => '200.000 B', '2022' => '200.000 B'],
                    'Q4' => ['2024' => '200.000 B', '2023' => '200.000 B', '2022' => '200.000 B'],
                ],
            ],
            'dividendData' => [
                'dividendPerSheet' => [
                    'Q1' => ['2024' => '2.000', '2023' => '1.500', '2022' => '1.000'],
                    'Q2' => ['2024' => '1.500', '2023' => '1.000', '2022' => '500'],
                    'Q3' => ['2024' => '1.000', '2023' => '500', '2022' => '0'],
                    'Q4' => ['2024' => '500', '2023' => '0', '2022' => '0'],
                ],
                'yield' => [
                    'Q1' => ['2024' => '3%', '2023' => '2.5%', '2022' => '2%'],
                    'Q2' => ['2024' => '2.5%', '2023' => '2%', '2022' => '1.5%'],
                    'Q3' => ['2024' => '2%', '2023' => '1.5%', '2022' => '1%'],
                    'Q4' => ['2024' => '1.5%', '2023' => '1%', '2022' => '0.5%'],
                ],
            ],
            'profitabilityRatioData' => [
                'ROE' => [
                    'Q1' => ['2024' => '15%', '2023' => '14%', '2022' => '13%'],
                    'Q2' => ['2024' => '14%', '2023' => '13%', '2022' => '12%'],
                    'Q3' => ['2024' => '13%', '2023' => '12%', '2022' => '11%'],
                    'Q4' => ['2024' => '12%', '2023' => '11%', '2022' => '10%'],
                ],
                'GPM' => [
                    'Q1' => ['2024' => '20%', '2023' => '19%', '2022' => '18%'],
                    'Q2' => ['2024' => '19%', '2023' => '18%', '2022' => '17%'],
                    'Q3' => ['2024' => '18%', '2023' => '17%', '2022' => '16%'],
                    'Q4' => ['2024' => '17%', '2023' => '16%', '2022' => '15%'],
                ],
                'NPM' => [
                    'Q1' => ['2024' => '10%', '2023' => '9%', '2022' => '8%'],
                    'Q2' => ['2024' => '9%', '2023' => '8%', '2022' => '7%'],
                    'Q3' => ['2024' => '8%', '2023' => '7%', '2022' => '6%'],
                    'Q4' => ['2024' => '7%', '2023' => '6%', '2022' => '5%'],
                ],
            ],
            'relativeRatioData' => [
                'EPS' => [
                    'Q1' => ['2024' => '100', '2023' => '90', '2022' => '80'],
                    'Q2' => ['2024' => '90', '2023' => '80', '2022' => '70'],
                    'Q3' => ['2024' => '80', '2023' => '70', '2022' => '60'],
                    'Q4' => ['2024' => '70', '2023' => '60', '2022' => '50'],
                ],
                'PER' => [
                    'Q1' => ['2024' => '15', '2023' => '14', '2022' => '13'],
                    'Q2' => ['2024' => '14', '2023' => '13', '2022' => '12'],
                    'Q3' => ['2024' => '13', '2023' => '12', '2022' => '11'],
                    'Q4' => ['2024' => '12', '2023' => '11', '2022' => '10'],
                ],
                'BVPS' => [
                    'Q1' => ['2024' => '500', '2023' => '450', '2022' => '400'],
                    'Q2' => ['2024' => '450', '2023' => '400', '2022' => '350'],
                    'Q3' => ['2024' => '400', '2023' => '350', '2022' => '300'],
                    'Q4' => ['2024' => '350', '2023' => '300', '2022' => '250'],
                ],
                'PBV' => [
                    'Q1' => ['2024' => '1.2', '2023' => '1.1', '2022' => '1'],
                    'Q2' => ['2024' => '1.1', '2023' => '1', '2022' => '0.9'],
                    'Q3' => ['2024' => '1', '2023' => '0.9', '2022' => '0.8'],
                    'Q4' => ['2024' => '0.9', '2023' => '0.8', '2022' => '0.7'],
                ],
            ],
            'liquidityRatioData' => [
                'DAR' => [
                    'Q1' => ['2024' => '60%', '2023' => '55%', '2022' => '50%'],
                    'Q2' => ['2024' => '55%', '2023' => '50%', '2022' => '45%'],
                    'Q3' => ['2024' => '50%', '2023' => '45%', '2022' => '40%'],
                    'Q4' => ['2024' => '45%', '2023' => '40%', '2022' => '35%'],
                ],
                'DER' => [
                    'Q1' => ['2024' => '1.5', '2023' => '1.4', '2022' => '1.3'],
                    'Q2' => ['2024' => '1.4', '2023' => '1.3', '2022' => '1.2'],
                    'Q3' => ['2024' => '1.3', '2023' => '1.2', '2022' => '1.1'],
                    'Q4' => ['2024' => '1.2', '2023' => '1.1', '2022' => '1'],
                ],
            ],
        ],
        'ADRO' => [
            'name' => 'Addaro',
            'address' => 'Kalimantan',
            'marketCap' => '150,25 T IDR',
            'price' => '80.5B',
            'growth' => '75.34%',
            'revenueData' => [
                'revenue' => [
                    'Q1' => ['2024' => '30.990 B', '2023' => '28.990 B', '2022' => '25.990 B'],
                    'Q2' => ['2024' => '22.990 B', '2023' => '20.990 B', '2022' => '18.990 B'],
                    'Q3' => ['2024' => '28.990 B', '2023' => '26.990 B', '2022' => '24.990 B'],
                    'Q4' => ['2024' => '20.990 B', '2023' => '18.990 B', '2022' => '16.990 B'],
                ],
                'grossProfit' => [
                    'Q1' => ['2024' => '20.990 B', '2023' => '18.990 B', '2022' => '16.990 B'],
                    'Q2' => ['2024' => '15.990 B', '2023' => '13.990 B', '2022' => '11.990 B'],
                    'Q3' => ['2024' => '18.990 B', '2023' => '16.990 B', '2022' => '14.990 B'],
                    'Q4' => ['2024' => '12.990 B', '2023' => '10.990 B', '2022' => '8.990 B'],
                ],
                'netProfit' => [
                    'Q1' => ['2024' => '10.990 B', '2023' => '8.990 B', '2022' => '6.990 B'],
                    'Q2' => ['2024' => '7.990 B', '2023' => '5.990 B', '2022' => '4.990 B'],
                    'Q3' => ['2024' => '9.990 B', '2023' => '7.990 B', '2022' => '5.990 B'],
                    'Q4' => ['2024' => '5.990 B', '2023' => '3.990 B', '2022' => '2.990 B'],
                ],
            ],
            'financialPositionData' => [
                'asset' => [
                    'Q1' => ['2024' => '600.000 B', '2023' => '550.000 B', '2022' => '500.000 B'],
                    'Q2' => ['2024' => '580.000 B', '2023' => '530.000 B', '2022' => '480.000 B'],
                    'Q3' => ['2024' => '560.000 B', '2023' => '510.000 B', '2022' => '460.000 B'],
                    'Q4' => ['2024' => '540.000 B', '2023' => '490.000 B', '2022' => '440.000 B'],
                ],
                'liability' => [
                    'Q1' => ['2024' => '400.000 B', '2023' => '350.000 B', '2022' => '300.000 B'],
                    'Q2' => ['2024' => '380.000 B', '2023' => '330.000 B', '2022' => '280.000 B'],
                    'Q3' => ['2024' => '360.000 B', '2023' => '310.000 B', '2022' => '260.000 B'],
                    'Q4' => ['2024' => '340.000 B', '2023' => '290.000 B', '2022' => '240.000 B'],
                ],
                'equity' => [
                    'Q1' => ['2024' => '200.000 B', '2023' => '200.000 B', '2022' => '200.000 B'],
                    'Q2' => ['2024' => '200.000 B', '2023' => '200.000 B', '2022' => '200.000 B'],
                    'Q3' => ['2024' => '200.000 B', '2023' => '200.000 B', '2022' => '200.000 B'],
                    'Q4' => ['2024' => '200.000 B', '2023' => '200.000 B', '2022' => '200.000 B'],
                ],
            ],
            'dividendData' => [
                'dividendPerSheet' => [
                    'Q1' => ['2024' => '2.500', '2023' => '2.000', '2022' => '1.500'],
                    'Q2' => ['2024' => '2.000', '2023' => '1.500', '2022' => '1.000'],
                    'Q3' => ['2024' => '1.500', '2023' => '1.000', '2022' => '500'],
                    'Q4' => ['2024' => '1.000', '2023' => '500', '2022' => '0'],
                ],
                'yield' => [
                    'Q1' => ['2024' => '3.5%', '2023' => '3%', '2022' => '2.5%'],
                    'Q2' => ['2024' => '3%', '2023' => '2.5%', '2022' => '2%'],
                    'Q3' => ['2024' => '2.5%', '2023' => '2%', '2022' => '1.5%'],
                    'Q4' => ['2024' => '2%', '2023' => '1.5%', '2022' => '1%'],
                ],
            ],
            'profitabilityRatioData' => [
                'ROE' => [
                    'Q1' => ['2024' => '16%', '2023' => '15%', '2022' => '14%'],
                    'Q2' => ['2024' => '15%', '2023' => '14%', '2022' => '13%'],
                    'Q3' => ['2024' => '14%', '2023' => '13%', '2022' => '12%'],
                    'Q4' => ['2024' => '13%', '2023' => '12%', '2022' => '11%'],
                ],
                'GPM' => [
                    'Q1' => ['2024' => '21%', '2023' => '20%', '2022' => '19%'],
                    'Q2' => ['2024' => '20%', '2023' => '19%', '2022' => '18%'],
                    'Q3' => ['2024' => '19%', '2023' => '18%', '2022' => '17%'],
                    'Q4' => ['2024' => '18%', '2023' => '17%', '2022' => '16%'],
                ],
                'NPM' => [
                    'Q1' => ['2024' => '11%', '2023' => '10%', '2022' => '9%'],
                    'Q2' => ['2024' => '10%', '2023' => '9%', '2022' => '8%'],
                    'Q3' => ['2024' => '9%', '2023' => '8%', '2022' => '7%'],
                    'Q4' => ['2024' => '8%', '2023' => '7%', '2022' => '6%'],
                ],
            ],
            'relativeRatioData' => [
                'EPS' => [
                    'Q1' => ['2024' => '110', '2023' => '100', '2022' => '90'],
                    'Q2' => ['2024' => '100', '2023' => '90', '2022' => '80'],
                    'Q3' => ['2024' => '90', '2023' => '80', '2022' => '70'],
                    'Q4' => ['2024' => '80', '2023' => '70', '2022' => '60'],
                ],
                'PER' => [
                    'Q1' => ['2024' => '16', '2023' => '15', '2022' => '14'],
                    'Q2' => ['2024' => '15', '2023' => '14', '2022' => '13'],
                    'Q3' => ['2024' => '14', '2023' => '13', '2022' => '12'],
                    'Q4' => ['2024' => '13', '2023' => '12', '2022' => '11'],
                ],
                'BVPS' => [
                    'Q1' => ['2024' => '550', '2023' => '500', '2022' => '450'],
                    'Q2' => ['2024' => '500', '2023' => '450', '2022' => '400'],
                    'Q3' => ['2024' => '450', '2023' => '400', '2022' => '350'],
                    'Q4' => ['2024' => '400', '2023' => '350', '2022' => '300'],
                ],
                'PBV' => [
                    'Q1' => ['2024' => '1.3', '2023' => '1.2', '2022' => '1.1'],
                    'Q2' => ['2024' => '1.2', '2023' => '1.1', '2022' => '1'],
                    'Q3' => ['2024' => '1.1', '2023' => '1', '2022' => '0.9'],
                    'Q4' => ['2024' => '1', '2023' => '0.9', '2022' => '0.8'],
                ],
            ],
            'liquidityRatioData' => [
                'DAR' => [
                    'Q1' => ['2024' => '65%', '2023' => '60%', '2022' => '55%'],
                    'Q2' => ['2024' => '60%', '2023' => '55%', '2022' => '50%'],
                    'Q3' => ['2024' => '55%', '2023' => '50%', '2022' => '45%'],
                    'Q4' => ['2024' => '50%', '2023' => '45%', '2022' => '40%'],
                ],
                'DER' => [
                    'Q1' => ['2024' => '1.6', '2023' => '1.5', '2022' => '1.4'],
                    'Q2' => ['2024' => '1.5', '2023' => '1.4', '2022' => '1.3'],
                    'Q3' => ['2024' => '1.4', '2023' => '1.3', '2022' => '1.2'],
                    'Q4' => ['2024' => '1.3', '2023' => '1.2', '2022' => '1.1'],
                ],
            ],
        ],
        // Add more companies here
    ];

    public function updatedSelectedCompany()
    {
        $this->emit('companyChanged', $this->companies[$this->selectedCompany]);
        $this->updateIncomeStatementData();
    }

    public function setActiveTab($tab)
    {
        $this->activeTab = $tab;
        if ($tab === 'key-statics') {
            $this->updateIncomeStatementData();
        }
    }

    public function updateIncomeStatementData()
    {
        $companyData = $this->companies[$this->selectedCompany];
        $this->incomeStatementData = [
            'categories' => array_keys($companyData['revenueData']['revenue']),
            'series' => [
                [
                    'name' => 'Revenue',
                    'data' => array_map(function ($val) {
                        return floatval(str_replace(' B', '', $val['2024']));
                    }, $companyData['revenueData']['revenue']),
                ],
                [
                    'name' => 'Gross Profit',
                    'data' => array_map(function ($val) {
                        return floatval(str_replace(' B', '', $val['2024']));
                    }, $companyData['revenueData']['grossProfit']),
                ],
                [
                    'name' => 'Net Profit',
                    'data' => array_map(function ($val) {
                        return floatval(str_replace(' B', '', $val['2024']));
                    }, $companyData['revenueData']['netProfit']),
                ],
            ],
        ];
    }
    public function render()
    {
        return view('livewire.dashboard-core', [
            'company' => $this->companies[$this->selectedCompany],
            'incomeStatementData' => $this->incomeStatementData,
        ]);
    }
}